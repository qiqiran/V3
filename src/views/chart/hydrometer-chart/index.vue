<template>
  <div class="chart-dom" ref="chartDom"></div>
</template>

<script lang="ts">
import { Ref } from "vue";
import { defineComponent, ref, unref, onMounted, nextTick } from "vue";

import { HydrometerChart } from "./index";

import { useWindowSizeFn } from "src/hooks/event/useWindowSizeFn";

export default defineComponent({
  setup() {
    const chartDom: Ref<HTMLElement | null> = ref(null);
    onMounted(() => {
      setTimeout(() => {
        const chart = new HydrometerChart((chartDom as Ref<HTMLElement>).value, "light");
        // chart.draw({
        //   minx: 0.0,
        //   maxx: 373.0,
        //   miny: 30.0,
        //   maxy: 78.0,
        //   // 缆道高程
        //   hh: 78.0,
        //   // 水面浮点位置
        //   zx: 227.6,
        //   // 水平计数器起点距
        //   qdj: 230.0,
        //   // 水平计数器零点位置
        //   h0: 4.6,
        //   // 水位
        //   z: 46.0,
        //   // 测速仪入水深度
        //   mf: 1,
        //   tp: 4,
        //   r: 0,
        //   date: "2020-10-16 10:30",
        //   x: [0.0, 7.1, 28.8, 30.1, 30.1, 30.1, 60.0, 80.0, 110.0, 140.0, 158.0, 185.0, 195.0, 212.0, 220.0, 229.0, 242.0, 256.0, 270.0, 287.0, 306.0, 315.0, 327.0, 345.0, 350.0, 355.2, 356.0, 373.0],
        //   y: [
        //     65.03, 65.01, 52.7, 52.52, 52.22, 51.08, 48.76, 48.78, 48.54, 47.78, 48.74, 47.88, 45.42, 35.62, 31.42, 32.02, 32.22, 36.42, 35.52, 34.42, 34.32, 35.02, 35.42, 46.32, 49.34, 52.22, 53.12,
        //     67.5,
        //   ],
        //   ll: [60.0, 110.0, 158.0, 185.0, 212.0, 229.0, 256.0, 287.0, 306.0, 327.0, 345.0],
        //   lm: [60.0, 110.0, 158.0, 185.0, 212.0, 229.0, 256.0, 287.0, 306.0, 327.0, 345.0],
        //   lh: [],
        //   mh: [],
        // });

        // chart.draw({
        //   minx: -15.0,
        //   maxx: 80.5,
        //   miny: 16.0,
        //   maxy: 30.65,
        //   hh: 30.65,
        //   zx: 57.0,
        //   h0: 25.8,
        //   z: 20.88,
        //   qdj: 10.0,
        //   mf: 0,
        //   tp: 7,
        //   r: 1,
        //   date: "2017-11-13 00:00",
        //   // 测速仪入水深度
        //   tz: -2,
        //   x: [
        //     -15.0, -11.6, -4.0, 0.0, 0.4, 0.6, 1.2, 7.3, 17.3, 17.4, 17.8, 18.3, 19.3, 20.3, 21.3, 21.8, 22.3, 22.8, 23.3, 23.8, 24.3, 24.8, 25.3, 25.8, 26.3, 26.8, 27.3, 27.8, 28.3, 28.8, 29.3, 29.8,
        //     30.3, 30.8, 31.3, 31.8, 32.3, 32.8, 33.3, 33.8, 34.3, 34.8, 35.3, 35.8, 36.3, 36.8, 37.3, 37.8, 38.3, 38.8, 39.3, 39.8, 40.3, 40.8, 41.3, 42.3, 43.3, 44.3, 45.3, 46.3, 47.3, 48.3, 49.3,
        //     50.3, 51.3, 52.3, 53.3, 54.3, 55.3, 56.3, 56.5, 65.5, 68.3, 69.2, 72.3, 72.4, 79.1, 80.5,
        //   ],
        //   y: [
        //     27.88, 27.83, 27.85, 27.64, 27.64, 26.6, 26.58, 24.04, 20.14, 19.03, 18.95, 18.87, 18.85, 18.88, 18.4, 18.27, 18.13, 17.91, 17.68, 17.48, 17.35, 17.46, 17.26, 17.45, 17.42, 17.29, 17.18,
        //     17.19, 17.19, 17.19, 17.14, 17.09, 17.13, 16.83, 16.83, 16.83, 16.82, 16.88, 16.83, 16.79, 16.84, 16.89, 16.97, 17.09, 17.13, 17.24, 17.31, 17.39, 17.45, 17.46, 17.52, 17.59, 17.65, 17.79,
        //     17.82, 17.87, 17.97, 18.03, 18.05, 18.15, 18.22, 18.4, 18.42, 18.52, 18.59, 18.7, 18.72, 18.8, 18.82, 18.9, 18.95, 19.14, 20.37, 22.27, 23.46, 25.12, 25.1, 25.69,
        //   ],
        //   ll: [],
        //   lm: [],
        //   lh: [],
        //   mh: [],
        // });

        chart.draw({
          minx: 0.0,
          maxx: 187.8,
          miny: 4237.0,
          maxy: 4242.0,
          hh: 4242.0,
          zx: 150.0,
          h0: -1.0,
          z: 4238.67,
          qdj: 0.0,
          mf: 1,
          tp: 5,
          r: 1,
          date: "2020-12-15 00:00",
          x: [
            0.0, 48.4, 61.8, 61.9, 62.8, 97.0, 114.7, 132.0, 137.4, 139.8, 139.9, 140.5, 141.6, 144.0, 146.0, 147.7, 147.8, 150.3, 152.9, 154.6, 155.4, 155.4, 156.0, 156.9, 159.5, 163.2, 167.0, 167.9,
            173.3, 173.9, 175.3, 177.5, 178.5, 186.3, 187.8,
          ],
          y: [
            4239.04, 4239.1, 4239.14, 4239.14, 4239.0, 4239.18, 4239.27, 4239.18, 4239.0, 4238.92, 4238.92, 4238.4, 4238.14, 4238.2, 4238.07, 4237.92, 4237.92, 4237.94, 4237.94, 4238.17, 4238.4,
            4238.42, 4238.86, 4238.85, 4239.12, 4238.7, 4238.89, 4239.0, 4239.75, 4240.0, 4240.47, 4241.0, 4240.23, 4241.38, 4241.38,
          ],
          ll: [120.0, 61.8, 17.0],
          lm: [20.0, 71.8, 67.0],
          lh: [30.0, 85.9, 150.0],
          mh: [41.8, 81.9, 150.0],
        });
      }, 1);
      // const { resize } = chart.getInstance();

      // chartDom.value?.addEventListener("resize", () => {
      //   console.log("resize");
      // });

      // const [start] = useWindowSizeFn(() => {
      //   console.log("windowResize");
      //   resize();
      // });
      // start();
    });

    return { chartDom };
  },
});
</script>

<style lang="less" scoped>
.chart-dom {
  width: 100%;
  height: 100%;
}
</style>